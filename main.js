!function(){"use strict";var e=class{constructor(e,t){this._inputSelector=e.inputSelector,this._submitButtonSelector=e.submitButtonSelector,this._inactiveButtonClass=e.inactiveButtonClass,this._inputErrorClass=e.inputErrorClass,this._errorClass=e.errorClass,this._form=t}_showInputError(e){const t=this._form.querySelector(`#${e.id}-error`);e.classList.add(this._inputErrorClass),t.textContent=e.validationMessage,t.classList.add(this._errorClass)}_hideInputError(e){const t=this._form.querySelector(`#${e.id}-error`);e.classList.remove(this._inputErrorClass),t.textContent=""}_checkInputValidity(e){e.validity.valid?this._hideInputError(e):this._showInputError(e)}_checkFormValidity(e){return e.every((e=>e.validity.valid))}disableSubmitButton(){this._submitButton.classList.add(this._inactiveButtonClass),this._submitButton.disabled=!0}enableSubmitButton(){this._submitButton.classList.remove(this._inactiveButtonClass),this._submitButton.disabled=!1}resetValidation(){this._toggleButtonState(),this._inputEls.forEach((e=>{this._hideInputError(e)}))}_toggleButtonState(){this._checkFormValidity(this._inputEls)?this.enableSubmitButton():this.disableSubmitButton()}_setEventListeners(){this._inputEls=[...this._form.querySelectorAll(this._inputSelector)],this._submitButton=this._form.querySelector(this._submitButtonSelector),this._inputEls.forEach((e=>{e.addEventListener("input",(()=>{this._checkInputValidity(e),this._toggleButtonState()}))}))}enableValidation(){this._form.addEventListener("submit",(e=>{e.preventDefault()})),this._setEventListeners(),this._toggleButtonState()}};class t{constructor(e,t,s,i,r,n){this._name=e.name,this._link=e.link,this._ownerId=e.owner._id,this._cardId=e._id,this._likes=e.likes,this._templateSelector=t,this._handleImageClick=s,this._handleLike=r,this._handleDeleteCard=i,this._userId=n}_setEventListeners(){this._likeButton.addEventListener("click",(()=>{this._handleLike(this._cardId)})),this._deleteButton.addEventListener("click",(()=>{this._handleDeleteCard(this)})),this._cardImage.addEventListener("click",(()=>this._handleImageClick({name:this._name,link:this._link})))}deleteCard(){this._card.remove(),this._card=null}updateLikes(e){this._likes=e,this._renderLikes()}isLiked(){return this._likes.some((e=>e._id===this._userId))}_renderLikes(){this._likeNumber.textContent=this._likes.length,this.isLiked()?this._likeButton.classList.add("card__like-button_active"):this._likeButton.classList.remove("card__like-button_active")}getView(){return this._card=document.querySelector(this._templateSelector).content.querySelector(".card").cloneNode(!0),this._cardTitle=this._card.querySelector(".card__title"),this._cardImage=this._card.querySelector(".card__image"),this._likeButton=this._card.querySelector(".card__like-button"),this._deleteButton=this._card.querySelector(".card__delete-button"),this._likeNumber=this._card.querySelector(".card__like-number"),this._ownerId!==this._userId&&this._deleteButton.remove(),this._renderLikes(),this._cardTitle.textContent=this._name,this._cardImage.alt=this._name,this._cardImage.src=this._link,this._setEventListeners(),this._card}}class s{constructor(e){let{popupSelector:t}=e;this._popupElement=document.querySelector(t),this._popupCloseButton=this._popupElement.querySelector(".modal__close")}open(){this._popupElement.classList.add("modal_opened"),this._popupElement.addEventListener("click",this._handleRemoteClose),document.addEventListener("keydown",this._handleEscClose)}close(){this._popupElement.classList.remove("modal_opened"),this._popupElement.removeEventListener("click",this._handleRemoteClose),document.removeEventListener("keydown",this._handleEscClose)}_handleEscClose=e=>{"Escape"===e.key&&this.close()};_handleRemoteClose=e=>{e.target.classList.contains("modal")&&this.close()};setEventListeners(){this._popupCloseButton.addEventListener("click",(()=>{this.close()}))}}class i extends s{constructor(e,t){super({popupSelector:e}),this._popupForm=this._popupElement.querySelector(".modal__form"),this._handleFormSubmit=t,this._saveButton=this._popupForm.querySelector(".modal__save")}close(){this._popupForm.reset(),super.close()}setButtonText(e){this._saveButton.textContent=e}_getInputValues(){return this._inputValues={},this._inputElements.forEach((e=>{this._inputValues[e.name]=e.value})),this._inputValues}setEventListeners(){super.setEventListeners(),this._inputElements=this._popupForm.querySelectorAll(".modal__form-input"),this._popupForm.addEventListener("submit",(e=>{e.preventDefault(),this._handleFormSubmit(this._getInputValues())}))}}const r=document.querySelector(".profile__avatar-container"),n=document.forms["update-avatar-form"],o=document.querySelector(".profile__rectangle"),a=document.querySelector("#modal__form-title"),l=document.querySelector("#modal__form-description"),h=document.forms["profile-form"],c=document.querySelector(".profile__add-button"),_=document.forms["card-form"],d=(document.querySelectorAll(".card__delete-button"),{inputSelector:".modal__form-input",submitButtonSelector:".modal__save",inactiveButtonClass:"modal__save_disabled",inputErrorClass:"modal__input_type_error",errorClass:"modal__error_visible"}),u=new class{constructor(e){let{baseUrl:t,headers:s}=e;this._baseUrl=t,this._authorization=s.authorization,this._contentType=s["content-type"]}getUserInformation(){return fetch(`${this._baseUrl}/users/me`,{headers:{authorization:this._authorization,"content-type":this._contentType}}).then(this._handleServerResponse)}editUserInformation(e){return fetch(`${this._baseUrl}/users/me`,{method:"PATCH",headers:{authorization:this._authorization,"content-type":this._contentType},body:JSON.stringify({name:e.title,about:e.subtitle})}).then(this._handleServerResponse)}addNewCard(e){return fetch(`${this._baseUrl}/cards`,{method:"POST",headers:{authorization:this._authorization,"content-type":this._contentType},body:JSON.stringify({name:e.name,link:e.link})}).then(this._handleServerResponse)}handleDeleteCard(e){return fetch(`${this._baseUrl}/cards/`+e,{method:"DELETE",headers:{authorization:this._authorization,"content-type":this._contentType}}).then(this._handleServerResponse)}getInitialCards(){return fetch(`${this._baseUrl}/cards`,{headers:{authorization:this._authorization,"content-type":this._contentType}}).then(this._handleServerResponse)}handleSubmitLike(e){return fetch(`${this._baseUrl}/cards/likes/`+e,{method:"PUT",headers:{authorization:this._authorization,"content-type":this._contentType}}).then(this._handleServerResponse)}handleDeleteLike(e){return fetch(`${this._baseUrl}/cards/likes/`+e,{method:"DELETE",headers:{authorization:this._authorization,"content-type":this._contentType}}).then(this._handleServerResponse)}updateProfilePicture(e){return fetch(`${this._baseUrl}/users/me/avatar`,{method:"PATCH",headers:{authorization:this._authorization,"content-type":this._contentType},body:JSON.stringify({avatar:e.avatar})}).then(this._handleServerResponse)}_handleServerResponse(e){return e.ok?e.json():Promise.reject(`Error: ${e.status}`)}}({baseUrl:"https://around.nomoreparties.co/v1/group-12",headers:{authorization:"02a3c077-82c6-4270-8df6-e8c1f2fec9e8","content-type":"application/json"}});let p;Promise.all([u.getUserInformation(),u.getInitialCards()]).then((e=>{let[t,s]=e;v.setUserInfo(t),v.setAvatar(t),p=t._id,m.renderItems(s.reverse())})).catch((e=>console.error(e)));const m=new class{constructor(e,t){let{renderer:s}=e;this._renderer=s,this._container=document.querySelector(t)}renderItems=e=>{e.forEach((e=>{this._renderer(e)}))};addItem(e){this._container.prepend(e)}}({renderer:e=>{const s=function(e){const s=new t(e,".card__template",(e=>{b.open(e)}),(e=>{f.open(),f.setSubmitAction((()=>{f.setButtonText("Deleting..."),u.handleDeleteCard(e._cardId).then((()=>{s.deleteCard(),f.close()})).finally((()=>{f.setButtonText("Yes")})).catch((e=>console.error(e)))}))}),(e=>{s.isLiked()?u.handleDeleteLike(e).then((e=>s.updateLikes(e.likes))).catch((e=>console.error(e))):u.handleSubmitLike(e).then((e=>s.updateLikes(e.likes))).catch((e=>console.error(e)))}),p);return s.getView()}(e);m.addItem(s)}},".gallery__cards"),v=new class{constructor(e){let{nameSelector:t,descriptionSelector:s,avatarSelector:i}=e;this._name=document.querySelector(t),this._description=document.querySelector(s),this._avatar=document.querySelector(i)}getUserInfo(){return{name:this._name.textContent,description:this._description.textContent}}setUserInfo(e){this._name.textContent=e.name,this._description.textContent=e.about}setAvatar(e){this._avatar.src=e.avatar}}({nameSelector:".profile__title",descriptionSelector:".profile__description",avatarSelector:".profile__avatar"}),S=new i("#modal__edit-profile",(e=>{S.setButtonText("Saving..."),u.editUserInformation(e).then((e=>{v.setUserInfo(e),v.setAvatar(e),S.close()})).finally((()=>{S.setButtonText("Save")})).catch((e=>console.error(e)))}));S.setEventListeners(),o.addEventListener("click",(()=>{S.open();const{description:e,name:t}=v.getUserInfo();a.value=t,l.value=e,k.resetValidation()}));const y=new i("#modal__new-item",(e=>{y.setButtonText("Creating..."),u.addNewCard(e).then((e=>{m.renderItems([e]),y.close()})).finally((()=>{y.setButtonText("Create")})).catch((e=>console.error(e)))}));y.setEventListeners(),c.addEventListener("click",(()=>{y.open(),L.resetValidation()}));const E=new i("#modal__update-avatar",(e=>{E.setButtonText("Saving..."),u.updateProfilePicture(e).then((e=>{u.getUserInformation(e).then((e=>{v.setAvatar(e),E.close()})).finally((()=>{E.setButtonText("Save")})).catch((e=>console.error(e)))}))}));E.setEventListeners(),r.addEventListener("click",(()=>{E.open()}));const f=new class extends s{constructor(e){super({popupSelector:e}),this._popupForm=this._popupElement.querySelector(".modal__form"),this._saveButton=this._popupForm.querySelector(".modal__save")}setSubmitAction(e){this._submitAction=e}setButtonText(e){this._saveButton.textContent=e}setEventListeners(){super.setEventListeners(),this._popupForm.addEventListener("submit",((e,t)=>{e.preventDefault(),this._submitAction(t)}))}}("#modal__delete-picture");f.setEventListeners();const b=new class extends s{constructor(e){super({popupSelector:e}),this._previewImage=this._popupElement.querySelector(".modal__picture"),this._previewCaption=this._popupElement.querySelector(".modal__image-description")}open(e){super.open(),this._previewImage.src=e.link,this._previewImage.alt=e.name,this._previewCaption.textContent=e.name}}("#modal__picture-popup");b.setEventListeners();const k=new e(d,h);k.enableValidation();const L=new e(d,_);L.enableValidation(),new e(d,n).enableValidation()}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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SVMsRUFBYzFNLEVBQVN3SCxHQUNyRHlFLEVBQWtCdEosbUJBQ2xCLE1BQU13SixFQUF1QixJQUFJTyxFQUFjMU0sRUFBUzBILEdBQ3hEeUUsRUFBcUJ4SixtQkFDYSxJQUFJK0osRUFBYzFNLEVBQVNtSCxHQUNuQ3hFLGtCIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9hcm91bmR0aGV1cy8uL3NyYy9jb21wb25lbnRzL0Zvcm1WYWxpZGF0b3IuanMiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9hcm91bmR0aGV1cy8uL3NyYy9jb21wb25lbnRzL0NhcmQuanMiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9hcm91bmR0aGV1cy8uL3NyYy9jb21wb25lbnRzL1BvcHVwLmpzIiwid2VicGFjazovL3NlX3Byb2plY3RfYXJvdW5kdGhldXMvLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhGb3JtLmpzIiwid2VicGFjazovL3NlX3Byb2plY3RfYXJvdW5kdGhldXMvLi9zcmMvdXRpbHMvY29uc3RhbnRzLmpzIiwid2VicGFjazovL3NlX3Byb2plY3RfYXJvdW5kdGhldXMvLi9zcmMvcGFnZXMvaW5kZXguanMiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9hcm91bmR0aGV1cy8uL3NyYy91dGlscy9BcGkuanMiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9hcm91bmR0aGV1cy8uL3NyYy9jb21wb25lbnRzL1NlY3Rpb24uanMiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9hcm91bmR0aGV1cy8uL3NyYy9jb21wb25lbnRzL1VzZXJJbmZvLmpzIiwid2VicGFjazovL3NlX3Byb2plY3RfYXJvdW5kdGhldXMvLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhDb25maXJtYXRpb24uanMiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9hcm91bmR0aGV1cy8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aEltYWdlLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImNsYXNzIEZvcm1WYWxpZGF0b3Ige1xyXG4gIGNvbnN0cnVjdG9yKG9wdGlvbnMsIGZvcm0pIHtcclxuICAgIHRoaXMuX2lucHV0U2VsZWN0b3IgPSBvcHRpb25zLmlucHV0U2VsZWN0b3I7XHJcbiAgICB0aGlzLl9zdWJtaXRCdXR0b25TZWxlY3RvciA9IG9wdGlvbnMuc3VibWl0QnV0dG9uU2VsZWN0b3I7XHJcbiAgICB0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzID0gb3B0aW9ucy5pbmFjdGl2ZUJ1dHRvbkNsYXNzO1xyXG4gICAgdGhpcy5faW5wdXRFcnJvckNsYXNzID0gb3B0aW9ucy5pbnB1dEVycm9yQ2xhc3M7XHJcbiAgICB0aGlzLl9lcnJvckNsYXNzID0gb3B0aW9ucy5lcnJvckNsYXNzO1xyXG5cclxuICAgIHRoaXMuX2Zvcm0gPSBmb3JtO1xyXG4gIH1cclxuXHJcbiAgX3Nob3dJbnB1dEVycm9yKGlucHV0RWwpIHtcclxuICAgIGNvbnN0IGlucHV0RXJyb3IgPSB0aGlzLl9mb3JtLnF1ZXJ5U2VsZWN0b3IoYCMke2lucHV0RWwuaWR9LWVycm9yYCk7XHJcblxyXG4gICAgaW5wdXRFbC5jbGFzc0xpc3QuYWRkKHRoaXMuX2lucHV0RXJyb3JDbGFzcyk7XHJcbiAgICBpbnB1dEVycm9yLnRleHRDb250ZW50ID0gaW5wdXRFbC52YWxpZGF0aW9uTWVzc2FnZTtcclxuICAgIGlucHV0RXJyb3IuY2xhc3NMaXN0LmFkZCh0aGlzLl9lcnJvckNsYXNzKTtcclxuICB9XHJcblxyXG4gIF9oaWRlSW5wdXRFcnJvcihpbnB1dEVsKSB7XHJcbiAgICBjb25zdCBpbnB1dEVycm9yID0gdGhpcy5fZm9ybS5xdWVyeVNlbGVjdG9yKGAjJHtpbnB1dEVsLmlkfS1lcnJvcmApO1xyXG5cclxuICAgIGlucHV0RWwuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9pbnB1dEVycm9yQ2xhc3MpO1xyXG4gICAgaW5wdXRFcnJvci50ZXh0Q29udGVudCA9IFwiXCI7XHJcbiAgfVxyXG5cclxuICBfY2hlY2tJbnB1dFZhbGlkaXR5KGlucHV0RWwpIHtcclxuICAgIGlmICghaW5wdXRFbC52YWxpZGl0eS52YWxpZCkge1xyXG4gICAgICB0aGlzLl9zaG93SW5wdXRFcnJvcihpbnB1dEVsKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHRoaXMuX2hpZGVJbnB1dEVycm9yKGlucHV0RWwpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgX2NoZWNrRm9ybVZhbGlkaXR5KGlucHV0cykge1xyXG4gICAgcmV0dXJuIGlucHV0cy5ldmVyeSgoaW5wdXQpID0+IGlucHV0LnZhbGlkaXR5LnZhbGlkKTtcclxuICB9XHJcblxyXG4gIGRpc2FibGVTdWJtaXRCdXR0b24oKSB7XHJcbiAgICB0aGlzLl9zdWJtaXRCdXR0b24uY2xhc3NMaXN0LmFkZCh0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcclxuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5kaXNhYmxlZCA9IHRydWU7XHJcbiAgfVxyXG5cclxuICBlbmFibGVTdWJtaXRCdXR0b24oKSB7XHJcbiAgICB0aGlzLl9zdWJtaXRCdXR0b24uY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcclxuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5kaXNhYmxlZCA9IGZhbHNlO1xyXG4gIH1cclxuXHJcbiAgcmVzZXRWYWxpZGF0aW9uKCkge1xyXG4gICAgdGhpcy5fdG9nZ2xlQnV0dG9uU3RhdGUoKTtcclxuXHJcbiAgICB0aGlzLl9pbnB1dEVscy5mb3JFYWNoKChpbnB1dEVsKSA9PiB7XHJcbiAgICAgIHRoaXMuX2hpZGVJbnB1dEVycm9yKGlucHV0RWwpO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBfdG9nZ2xlQnV0dG9uU3RhdGUoKSB7XHJcbiAgICBjb25zdCBpc0Zvcm1WYWxpZCA9IHRoaXMuX2NoZWNrRm9ybVZhbGlkaXR5KHRoaXMuX2lucHV0RWxzKTtcclxuXHJcbiAgICBpZiAoIWlzRm9ybVZhbGlkKSB7XHJcbiAgICAgIHRoaXMuZGlzYWJsZVN1Ym1pdEJ1dHRvbigpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgdGhpcy5lbmFibGVTdWJtaXRCdXR0b24oKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIF9zZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgIHRoaXMuX2lucHV0RWxzID0gWy4uLnRoaXMuX2Zvcm0ucXVlcnlTZWxlY3RvckFsbCh0aGlzLl9pbnB1dFNlbGVjdG9yKV07XHJcbiAgICB0aGlzLl9zdWJtaXRCdXR0b24gPSB0aGlzLl9mb3JtLnF1ZXJ5U2VsZWN0b3IodGhpcy5fc3VibWl0QnV0dG9uU2VsZWN0b3IpO1xyXG5cclxuICAgIHRoaXMuX2lucHV0RWxzLmZvckVhY2goKGlucHV0RWwpID0+IHtcclxuICAgICAgaW5wdXRFbC5hZGRFdmVudExpc3RlbmVyKFwiaW5wdXRcIiwgKCkgPT4ge1xyXG4gICAgICAgIHRoaXMuX2NoZWNrSW5wdXRWYWxpZGl0eShpbnB1dEVsKTtcclxuICAgICAgICB0aGlzLl90b2dnbGVCdXR0b25TdGF0ZSgpO1xyXG4gICAgICB9KTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgZW5hYmxlVmFsaWRhdGlvbigpIHtcclxuICAgIHRoaXMuX2Zvcm0uYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoZXZ0KSA9PiB7XHJcbiAgICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgfSk7XHJcbiAgICB0aGlzLl9zZXRFdmVudExpc3RlbmVycygpO1xyXG4gICAgdGhpcy5fdG9nZ2xlQnV0dG9uU3RhdGUoKTtcclxuICB9XHJcbn1cclxuXHJcbmV4cG9ydCBkZWZhdWx0IEZvcm1WYWxpZGF0b3I7XHJcbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIENhcmQge1xyXG4gIGNvbnN0cnVjdG9yKFxyXG4gICAgZGF0YSxcclxuICAgIHRlbXBsYXRlU2VsZWN0b3IsXHJcbiAgICBoYW5kbGVJbWFnZUNsaWNrLFxyXG4gICAgaGFuZGxlRGVsZXRlQ2FyZCxcclxuICAgIGhhbmRsZUxpa2UsXHJcbiAgICB1c2VySWRcclxuICApIHtcclxuICAgIHRoaXMuX25hbWUgPSBkYXRhLm5hbWU7XHJcbiAgICB0aGlzLl9saW5rID0gZGF0YS5saW5rO1xyXG4gICAgdGhpcy5fb3duZXJJZCA9IGRhdGEub3duZXIuX2lkO1xyXG4gICAgdGhpcy5fY2FyZElkID0gZGF0YS5faWQ7XHJcbiAgICB0aGlzLl9saWtlcyA9IGRhdGEubGlrZXM7XHJcbiAgICB0aGlzLl90ZW1wbGF0ZVNlbGVjdG9yID0gdGVtcGxhdGVTZWxlY3RvcjtcclxuICAgIHRoaXMuX2hhbmRsZUltYWdlQ2xpY2sgPSBoYW5kbGVJbWFnZUNsaWNrO1xyXG4gICAgLy8gdGhpcy5faGFuZGxlU3VibWl0TGlrZSA9IGhhbmRsZVN1Ym1pdExpa2U7XHJcbiAgICAvLyB0aGlzLl9oYW5kbGVEZWxldGVsaWtlID0gaGFuZGxlRGVsZXRlTGlrZTtcclxuICAgIHRoaXMuX2hhbmRsZUxpa2UgPSBoYW5kbGVMaWtlO1xyXG4gICAgdGhpcy5faGFuZGxlRGVsZXRlQ2FyZCA9IGhhbmRsZURlbGV0ZUNhcmQ7XHJcbiAgICB0aGlzLl91c2VySWQgPSB1c2VySWQ7XHJcbiAgfVxyXG5cclxuICBfc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICAvLyBoYW5kbGUgbGlrZSBidXR0b25cclxuICAgIHRoaXMuX2xpa2VCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICAgICAgdGhpcy5faGFuZGxlTGlrZSh0aGlzLl9jYXJkSWQpO1xyXG4gICAgfSk7XHJcbiAgICAvLyByZW1vdmUgY2FyZFxyXG4gICAgdGhpcy5fZGVsZXRlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgICAgIHRoaXMuX2hhbmRsZURlbGV0ZUNhcmQodGhpcyk7XHJcbiAgICB9KTtcclxuICAgIC8vIG9wZW4gaW1hZ2UgcG9wdXBcclxuICAgIHRoaXMuX2NhcmRJbWFnZS5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT5cclxuICAgICAgdGhpcy5faGFuZGxlSW1hZ2VDbGljayh7IG5hbWU6IHRoaXMuX25hbWUsIGxpbms6IHRoaXMuX2xpbmsgfSlcclxuICAgICk7XHJcbiAgfVxyXG5cclxuICBkZWxldGVDYXJkKCkge1xyXG4gICAgdGhpcy5fY2FyZC5yZW1vdmUoKTtcclxuICAgIHRoaXMuX2NhcmQgPSBudWxsO1xyXG4gIH1cclxuXHJcbiAgdXBkYXRlTGlrZXMobGlrZXMpIHtcclxuICAgIC8vIHNldCBpbnN0YW5jZSB2YXJpYWJsZVxyXG4gICAgdGhpcy5fbGlrZXMgPSBsaWtlcztcclxuICAgIHRoaXMuX3JlbmRlckxpa2VzKCk7XHJcbiAgfVxyXG5cclxuICBpc0xpa2VkKCkge1xyXG4gICAgcmV0dXJuIHRoaXMuX2xpa2VzLnNvbWUoKGxpa2UpID0+IGxpa2UuX2lkID09PSB0aGlzLl91c2VySWQpO1xyXG4gIH1cclxuXHJcbiAgX3JlbmRlckxpa2VzKCkge1xyXG4gICAgdGhpcy5fbGlrZU51bWJlci50ZXh0Q29udGVudCA9IHRoaXMuX2xpa2VzLmxlbmd0aDtcclxuXHJcbiAgICBpZiAodGhpcy5pc0xpa2VkKCkpIHtcclxuICAgICAgdGhpcy5fbGlrZUJ1dHRvbi5jbGFzc0xpc3QuYWRkKFwiY2FyZF9fbGlrZS1idXR0b25fYWN0aXZlXCIpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgdGhpcy5fbGlrZUJ1dHRvbi5jbGFzc0xpc3QucmVtb3ZlKFwiY2FyZF9fbGlrZS1idXR0b25fYWN0aXZlXCIpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgZ2V0VmlldygpIHtcclxuICAgIHRoaXMuX2NhcmQgPSBkb2N1bWVudFxyXG4gICAgICAucXVlcnlTZWxlY3Rvcih0aGlzLl90ZW1wbGF0ZVNlbGVjdG9yKVxyXG4gICAgICAuY29udGVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRcIilcclxuICAgICAgLmNsb25lTm9kZSh0cnVlKTtcclxuICAgIHRoaXMuX2NhcmRUaXRsZSA9IHRoaXMuX2NhcmQucXVlcnlTZWxlY3RvcihcIi5jYXJkX190aXRsZVwiKTtcclxuICAgIHRoaXMuX2NhcmRJbWFnZSA9IHRoaXMuX2NhcmQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19pbWFnZVwiKTtcclxuICAgIHRoaXMuX2xpa2VCdXR0b24gPSB0aGlzLl9jYXJkLnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fbGlrZS1idXR0b25cIik7XHJcbiAgICB0aGlzLl9kZWxldGVCdXR0b24gPSB0aGlzLl9jYXJkLnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fZGVsZXRlLWJ1dHRvblwiKTtcclxuICAgIHRoaXMuX2xpa2VOdW1iZXIgPSB0aGlzLl9jYXJkLnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fbGlrZS1udW1iZXJcIik7XHJcbiAgICAvL2dldCBjYXJkIHZpZXdcclxuICAgIGlmICh0aGlzLl9vd25lcklkICE9PSB0aGlzLl91c2VySWQpIHtcclxuICAgICAgdGhpcy5fZGVsZXRlQnV0dG9uLnJlbW92ZSgpO1xyXG4gICAgfVxyXG5cclxuICAgIHRoaXMuX3JlbmRlckxpa2VzKCk7XHJcblxyXG4gICAgdGhpcy5fY2FyZFRpdGxlLnRleHRDb250ZW50ID0gdGhpcy5fbmFtZTtcclxuICAgIHRoaXMuX2NhcmRJbWFnZS5hbHQgPSB0aGlzLl9uYW1lO1xyXG4gICAgdGhpcy5fY2FyZEltYWdlLnNyYyA9IHRoaXMuX2xpbms7XHJcbiAgICAvL3NldCBldmVudCBsaXN0ZW5lcnNcclxuICAgIHRoaXMuX3NldEV2ZW50TGlzdGVuZXJzKCk7XHJcbiAgICAvL3JldHVybiBjYXJkXHJcbiAgICByZXR1cm4gdGhpcy5fY2FyZDtcclxuICB9XHJcbn1cclxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXAge1xyXG4gIGNvbnN0cnVjdG9yKHsgcG9wdXBTZWxlY3RvciB9KSB7XHJcbiAgICB0aGlzLl9wb3B1cEVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHBvcHVwU2VsZWN0b3IpO1xyXG4gICAgdGhpcy5fcG9wdXBDbG9zZUJ1dHRvbiA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19jbG9zZVwiKTtcclxuICB9XHJcblxyXG4gIG9wZW4oKSB7XHJcbiAgICB0aGlzLl9wb3B1cEVsZW1lbnQuY2xhc3NMaXN0LmFkZChcIm1vZGFsX29wZW5lZFwiKTtcclxuICAgIHRoaXMuX3BvcHVwRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgdGhpcy5faGFuZGxlUmVtb3RlQ2xvc2UpO1xyXG4gICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgdGhpcy5faGFuZGxlRXNjQ2xvc2UpO1xyXG4gIH1cclxuXHJcbiAgY2xvc2UoKSB7XHJcbiAgICB0aGlzLl9wb3B1cEVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZShcIm1vZGFsX29wZW5lZFwiKTtcclxuICAgIHRoaXMuX3BvcHVwRWxlbWVudC5yZW1vdmVFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgdGhpcy5faGFuZGxlUmVtb3RlQ2xvc2UpO1xyXG4gICAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgdGhpcy5faGFuZGxlRXNjQ2xvc2UpO1xyXG4gIH1cclxuXHJcbiAgX2hhbmRsZUVzY0Nsb3NlID0gKGV2dCkgPT4ge1xyXG4gICAgaWYgKGV2dC5rZXkgPT09IFwiRXNjYXBlXCIpIHtcclxuICAgICAgdGhpcy5jbG9zZSgpO1xyXG4gICAgfVxyXG4gIH07XHJcblxyXG4gIF9oYW5kbGVSZW1vdGVDbG9zZSA9IChldnQpID0+IHtcclxuICAgIGlmIChldnQudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucyhcIm1vZGFsXCIpKSB7XHJcbiAgICAgIHRoaXMuY2xvc2UoKTtcclxuICAgIH1cclxuICB9O1xyXG5cclxuICBzZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgIHRoaXMuX3BvcHVwQ2xvc2VCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICAgICAgdGhpcy5jbG9zZSgpO1xyXG4gICAgfSk7XHJcbiAgfVxyXG59XHJcbiIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cC5qc1wiO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXBXaXRoRm9ybSBleHRlbmRzIFBvcHVwIHtcclxuICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yLCBoYW5kbGVGb3JtU3VibWl0KSB7XHJcbiAgICBzdXBlcih7IHBvcHVwU2VsZWN0b3IgfSk7XHJcbiAgICB0aGlzLl9wb3B1cEZvcm0gPSB0aGlzLl9wb3B1cEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fZm9ybVwiKTtcclxuICAgIHRoaXMuX2hhbmRsZUZvcm1TdWJtaXQgPSBoYW5kbGVGb3JtU3VibWl0O1xyXG4gICAgdGhpcy5fc2F2ZUJ1dHRvbiA9IHRoaXMuX3BvcHVwRm9ybS5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19zYXZlXCIpO1xyXG4gIH1cclxuXHJcbiAgY2xvc2UoKSB7XHJcbiAgICB0aGlzLl9wb3B1cEZvcm0ucmVzZXQoKTtcclxuICAgIHN1cGVyLmNsb3NlKCk7XHJcbiAgfVxyXG5cclxuICBzZXRCdXR0b25UZXh0KGRhdGEpIHtcclxuICAgIHRoaXMuX3NhdmVCdXR0b24udGV4dENvbnRlbnQgPSBkYXRhO1xyXG4gIH1cclxuXHJcbiAgX2dldElucHV0VmFsdWVzKCkge1xyXG4gICAgdGhpcy5faW5wdXRWYWx1ZXMgPSB7fTtcclxuICAgIHRoaXMuX2lucHV0RWxlbWVudHMuZm9yRWFjaCgoZWxlbWVudCkgPT4ge1xyXG4gICAgICB0aGlzLl9pbnB1dFZhbHVlc1tlbGVtZW50Lm5hbWVdID0gZWxlbWVudC52YWx1ZTtcclxuICAgIH0pO1xyXG4gICAgcmV0dXJuIHRoaXMuX2lucHV0VmFsdWVzO1xyXG4gIH1cclxuXHJcbiAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICBzdXBlci5zZXRFdmVudExpc3RlbmVycygpO1xyXG4gICAgdGhpcy5faW5wdXRFbGVtZW50cyA9XHJcbiAgICAgIHRoaXMuX3BvcHVwRm9ybS5xdWVyeVNlbGVjdG9yQWxsKFwiLm1vZGFsX19mb3JtLWlucHV0XCIpO1xyXG4gICAgdGhpcy5fcG9wdXBGb3JtLmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgKGV2dCkgPT4ge1xyXG4gICAgICBldnQucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgdGhpcy5faGFuZGxlRm9ybVN1Ym1pdCh0aGlzLl9nZXRJbnB1dFZhbHVlcygpKTtcclxuICAgIH0pO1xyXG4gIH1cclxufVxyXG4iLCJleHBvcnQgY29uc3QgaW5pdGlhbENhcmRzID0gW1xyXG4gIHtcclxuICAgIG5hbWU6IFwiQ29sb3JhZG8gU3ByaW5nc1wiLFxyXG4gICAgbGluazogXCJodHRwczovL2ltYWdlcy51bnNwbGFzaC5jb20vcGhvdG8tMTYxMjg5ODgyNTkyOS0zZWU4N2EzNjA4N2I/aXhsaWI9cmItNC4wLjMmaXhpZD1NM3d4TWpBM2ZEQjhNSHh3YUc5MGJ5MXdZV2RsZkh4OGZHVnVmREI4Zkh4OGZBJTNEJTNEJmF1dG89Zm9ybWF0JmZpdD1jcm9wJnc9MTE3MSZxPTgwXCIsXHJcbiAgfSxcclxuICB7XHJcbiAgICBuYW1lOiBcIk9qYWlcIixcclxuICAgIGxpbms6IFwiaHR0cHM6Ly9pbWFnZXMudW5zcGxhc2guY29tL3Bob3RvLTE2MDk5NjA3MjI0MzYtZTkwZTUzMDRkNDZiP2l4bGliPXJiLTQuMC4zJml4aWQ9TTN3eE1qQTNmREI4TUh4d2FHOTBieTF3WVdkbGZIeDhmR1Z1ZkRCOGZIeDhmQSUzRCUzRCZhdXRvPWZvcm1hdCZmaXQ9Y3JvcCZ3PTEwNzQmcT04MFwiLFxyXG4gIH0sXHJcbiAge1xyXG4gICAgbmFtZTogXCJMYWtlIFBvd2VsbFwiLFxyXG4gICAgbGluazogXCJodHRwczovL2ltYWdlcy51bnNwbGFzaC5jb20vcGhvdG8tMTU2NjkwOTc5MDAwNi05ZDNhMGQ5MzQzYTM/aXhsaWI9cmItNC4wLjMmaXhpZD1NM3d4TWpBM2ZEQjhNSHh3YUc5MGJ5MXdZV2RsZkh4OGZHVnVmREI4Zkh4OGZBJTNEJTNEJmF1dG89Zm9ybWF0JmZpdD1jcm9wJnc9MTA3NCZxPTgwXCIsXHJcbiAgfSxcclxuICB7XHJcbiAgICBuYW1lOiBcIkRlbnZlclwiLFxyXG4gICAgbGluazogXCJodHRwczovL2ltYWdlcy51bnNwbGFzaC5jb20vcGhvdG8tMTYxODM0MjgzNTMxNS01NmY0NzYxNmJmMzQ/aXhsaWI9cmItNC4wLjMmaXhpZD1NM3d4TWpBM2ZEQjhNSHh3YUc5MGJ5MXdZV2RsZkh4OGZHVnVmREI4Zkh4OGZBJTNEJTNEJmF1dG89Zm9ybWF0JmZpdD1jcm9wJnc9Njg3JnE9ODBcIixcclxuICB9LFxyXG4gIHtcclxuICAgIG5hbWU6IFwiUmVkbGFuZHNcIixcclxuICAgIGxpbms6IFwiaHR0cHM6Ly9pbWFnZXMudW5zcGxhc2guY29tL3Bob3RvLTE2MjU2MzkxOTI3NDctODllNzk3OTQ3NGQzP2l4bGliPXJiLTQuMC4zJml4aWQ9TTN3eE1qQTNmREI4TUh4d2FHOTBieTF3WVdkbGZIeDhmR1Z1ZkRCOGZIeDhmQSUzRCUzRCZhdXRvPWZvcm1hdCZmaXQ9Y3JvcCZ3PTEwNzQmcT04MFwiLFxyXG4gIH0sXHJcbiAge1xyXG4gICAgbmFtZTogXCJUZW5uZXNzZWUgTW91bnRhaW5zXCIsXHJcbiAgICBsaW5rOiBcImh0dHBzOi8vaW1hZ2VzLnVuc3BsYXNoLmNvbS9waG90by0xNjMzNjIyNjc0ODg1LTExZGM1YTc4M2FiNT9peGxpYj1yYi00LjAuMyZpeGlkPU0zd3hNakEzZkRCOE1IeHdhRzkwYnkxd1lXZGxmSHg4ZkdWdWZEQjhmSHg4ZkElM0QlM0QmYXV0bz1mb3JtYXQmZml0PWNyb3Amdz02ODcmcT04MFwiLFxyXG4gIH0sXHJcbl07XHJcblxyXG4vLyBQcm9maWxlIEVsZW1lbnRzXHJcblxyXG5leHBvcnQgY29uc3QgdXBkYXRlQXZhdGFyQ29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcclxuICBcIi5wcm9maWxlX19hdmF0YXItY29udGFpbmVyXCJcclxuKTtcclxuZXhwb3J0IGNvbnN0IHVwZGF0ZUF2YXRhckZvcm0gPSBkb2N1bWVudC5mb3Jtc1tcInVwZGF0ZS1hdmF0YXItZm9ybVwiXTtcclxuXHJcbi8vIEVkaXQgUHJvZmlsZSBNb2RhbCBFbGVtZW50c1xyXG5cclxuZXhwb3J0IGNvbnN0IGVkaXRQcm9maWxlQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19yZWN0YW5nbGVcIik7XHJcbmV4cG9ydCBjb25zdCBtb2RhbFRpdGxlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNtb2RhbF9fZm9ybS10aXRsZVwiKTtcclxuZXhwb3J0IGNvbnN0IG1vZGFsRGVzY3JpcHRpb24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFxyXG4gIFwiI21vZGFsX19mb3JtLWRlc2NyaXB0aW9uXCJcclxuKTtcclxuZXhwb3J0IGNvbnN0IGVkaXRQcm9maWxlTW9kYWxGb3JtID0gZG9jdW1lbnQuZm9ybXNbXCJwcm9maWxlLWZvcm1cIl07XHJcblxyXG4vLyBBZGQgUGljdHVyZXMgTW9kYWwgRWxlbWVudHNcclxuXHJcbmV4cG9ydCBjb25zdCBuZXdJdGVtTW9kYWxPcGVuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19hZGQtYnV0dG9uXCIpO1xyXG5leHBvcnQgY29uc3QgbmV3SXRlbU1vZGFsRm9ybSA9IGRvY3VtZW50LmZvcm1zW1wiY2FyZC1mb3JtXCJdO1xyXG5cclxuLy8gRGVsZXRlIENhcmQgRWxlbWVudHNcclxuXHJcbmV4cG9ydCBjb25zdCBkZWxldGVDYXJkQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcclxuICBcIi5jYXJkX19kZWxldGUtYnV0dG9uXCJcclxuKTtcclxuXHJcbi8qIC0tLS0tLS0tLS0tXHJcbkNhcmQgRWxlbWVudHNcclxuLS0tLS0tLS0tLS0gKi9cclxuXHJcbmV4cG9ydCBjb25zdCBjYXJkTGlzdCA9IFwiLmdhbGxlcnlfX2NhcmRzXCI7XHJcbmV4cG9ydCBjb25zdCB0ZW1wbGF0ZVNlbGVjdG9yID0gXCIuY2FyZF9fdGVtcGxhdGVcIjtcclxuXHJcbi8vIC0tLS0tIEZvcm0gVmFsaWRhdG9yIE9wdGlvbnMgLS0tLS0gLy9cclxuXHJcbmV4cG9ydCBjb25zdCBvcHRpb25zID0ge1xyXG4gIGlucHV0U2VsZWN0b3I6IFwiLm1vZGFsX19mb3JtLWlucHV0XCIsXHJcbiAgc3VibWl0QnV0dG9uU2VsZWN0b3I6IFwiLm1vZGFsX19zYXZlXCIsXHJcbiAgaW5hY3RpdmVCdXR0b25DbGFzczogXCJtb2RhbF9fc2F2ZV9kaXNhYmxlZFwiLFxyXG4gIGlucHV0RXJyb3JDbGFzczogXCJtb2RhbF9faW5wdXRfdHlwZV9lcnJvclwiLFxyXG4gIGVycm9yQ2xhc3M6IFwibW9kYWxfX2Vycm9yX3Zpc2libGVcIixcclxufTtcclxuIiwiaW1wb3J0IEZvcm1WYWxpZGF0b3IgZnJvbSBcIi4uL2NvbXBvbmVudHMvRm9ybVZhbGlkYXRvci5qc1wiO1xyXG5pbXBvcnQgQ2FyZCBmcm9tIFwiLi4vY29tcG9uZW50cy9DYXJkLmpzXCI7XHJcbmltcG9ydCBTZWN0aW9uIGZyb20gXCIuLi9jb21wb25lbnRzL1NlY3Rpb24uanNcIjtcclxuaW1wb3J0IFBvcHVwV2l0aEZvcm0gZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXBXaXRoRm9ybS5qc1wiO1xyXG5pbXBvcnQgUG9wdXBXaXRoSW1hZ2UgZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXBXaXRoSW1hZ2UuanNcIjtcclxuaW1wb3J0IFVzZXJJbmZvIGZyb20gXCIuLi9jb21wb25lbnRzL1VzZXJJbmZvLmpzXCI7XHJcbmltcG9ydCBBcGkgZnJvbSBcIi4uL3V0aWxzL0FwaS5qc1wiO1xyXG5pbXBvcnQge1xyXG4gIGVkaXRQcm9maWxlQnV0dG9uLFxyXG4gIGVkaXRQcm9maWxlTW9kYWxGb3JtLFxyXG4gIG1vZGFsVGl0bGUsXHJcbiAgbW9kYWxEZXNjcmlwdGlvbixcclxuICBuZXdJdGVtTW9kYWxPcGVuLFxyXG4gIG5ld0l0ZW1Nb2RhbEZvcm0sXHJcbiAgY2FyZExpc3QsXHJcbiAgdGVtcGxhdGVTZWxlY3RvcixcclxuICBvcHRpb25zLFxyXG4gIHVwZGF0ZUF2YXRhckNvbnRhaW5lcixcclxuICB1cGRhdGVBdmF0YXJGb3JtLFxyXG59IGZyb20gXCIuLi91dGlscy9jb25zdGFudHMuanNcIjtcclxuaW1wb3J0IFwiLi9pbmRleC5jc3NcIjtcclxuaW1wb3J0IFBvcHVwV2l0aENvbmZpcm1hdGlvbiBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cFdpdGhDb25maXJtYXRpb24uanNcIjtcclxuXHJcbi8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cclxuLy8gLS0tLS0gQVBJcyAtLS0tLSAvL1xyXG4vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXHJcblxyXG5jb25zdCBhcGkgPSBuZXcgQXBpKHtcclxuICBiYXNlVXJsOiBcImh0dHBzOi8vYXJvdW5kLm5vbW9yZXBhcnRpZXMuY28vdjEvZ3JvdXAtMTJcIixcclxuICBoZWFkZXJzOiB7XHJcbiAgICBhdXRob3JpemF0aW9uOiBcIjAyYTNjMDc3LTgyYzYtNDI3MC04ZGY2LWU4YzFmMmZlYzllOFwiLFxyXG4gICAgXCJjb250ZW50LXR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCIsXHJcbiAgfSxcclxufSk7XHJcblxyXG5sZXQgdXNlcklkO1xyXG5Qcm9taXNlLmFsbChbYXBpLmdldFVzZXJJbmZvcm1hdGlvbigpLCBhcGkuZ2V0SW5pdGlhbENhcmRzKCldKVxyXG4gIC50aGVuKChbdXNlciwgY2FyZHNdKSA9PiB7XHJcbiAgICB1c2VySW5mb3JtYXRpb24uc2V0VXNlckluZm8odXNlcik7XHJcbiAgICB1c2VySW5mb3JtYXRpb24uc2V0QXZhdGFyKHVzZXIpO1xyXG4gICAgdXNlcklkID0gdXNlci5faWQ7XHJcbiAgICBjYXJkU2VjdGlvbi5yZW5kZXJJdGVtcyhjYXJkcy5yZXZlcnNlKCkpO1xyXG4gIH0pXHJcbiAgLmNhdGNoKChlcnIpID0+IGNvbnNvbGUuZXJyb3IoZXJyKSk7XHJcblxyXG4vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xyXG4vLyAtLS0tLSBTRUNUSU9OUyAtLS0tLSAvL1xyXG4vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xyXG5cclxuZnVuY3Rpb24gY3JlYXRlQ2FyZChpdGVtKSB7XHJcbiAgY29uc3QgY2FyZCA9IG5ldyBDYXJkKFxyXG4gICAgaXRlbSxcclxuICAgIHRlbXBsYXRlU2VsZWN0b3IsXHJcbiAgICAoZGF0YSkgPT4ge1xyXG4gICAgICBwcmV2aWV3UGljdHVyZVBvcHVwLm9wZW4oZGF0YSk7XHJcbiAgICB9LFxyXG4gICAgKGRhdGEpID0+IHtcclxuICAgICAgZGVsZXRlQ2FyZFBvcHVwLm9wZW4oKTtcclxuICAgICAgZGVsZXRlQ2FyZFBvcHVwLnNldFN1Ym1pdEFjdGlvbigoKSA9PiB7XHJcbiAgICAgICAgZGVsZXRlQ2FyZFBvcHVwLnNldEJ1dHRvblRleHQoXCJEZWxldGluZy4uLlwiKTtcclxuICAgICAgICBhcGlcclxuICAgICAgICAgIC5oYW5kbGVEZWxldGVDYXJkKGRhdGEuX2NhcmRJZClcclxuICAgICAgICAgIC50aGVuKCgpID0+IHtcclxuICAgICAgICAgICAgY2FyZC5kZWxldGVDYXJkKCk7XHJcbiAgICAgICAgICAgIGRlbGV0ZUNhcmRQb3B1cC5jbG9zZSgpO1xyXG4gICAgICAgICAgfSlcclxuICAgICAgICAgIC5maW5hbGx5KCgpID0+IHtcclxuICAgICAgICAgICAgZGVsZXRlQ2FyZFBvcHVwLnNldEJ1dHRvblRleHQoXCJZZXNcIik7XHJcbiAgICAgICAgICB9KVxyXG4gICAgICAgICAgLmNhdGNoKChlcnIpID0+IGNvbnNvbGUuZXJyb3IoZXJyKSk7XHJcbiAgICAgIH0pO1xyXG4gICAgfSxcclxuICAgIChkYXRhKSA9PiB7XHJcbiAgICAgIGlmIChjYXJkLmlzTGlrZWQoKSkge1xyXG4gICAgICAgIGFwaVxyXG4gICAgICAgICAgLmhhbmRsZURlbGV0ZUxpa2UoZGF0YSlcclxuICAgICAgICAgIC50aGVuKChyZXNwb25zZSkgPT4gY2FyZC51cGRhdGVMaWtlcyhyZXNwb25zZS5saWtlcykpXHJcbiAgICAgICAgICAuY2F0Y2goKGVycikgPT4gY29uc29sZS5lcnJvcihlcnIpKTtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICBhcGlcclxuICAgICAgICAgIC5oYW5kbGVTdWJtaXRMaWtlKGRhdGEpXHJcbiAgICAgICAgICAudGhlbigocmVzcG9uc2UpID0+IGNhcmQudXBkYXRlTGlrZXMocmVzcG9uc2UubGlrZXMpKVxyXG4gICAgICAgICAgLmNhdGNoKChlcnIpID0+IGNvbnNvbGUuZXJyb3IoZXJyKSk7XHJcbiAgICAgIH1cclxuICAgIH0sXHJcbiAgICB1c2VySWRcclxuICApO1xyXG4gIHJldHVybiBjYXJkLmdldFZpZXcoKTtcclxufVxyXG5cclxuY29uc3QgY2FyZFNlY3Rpb24gPSBuZXcgU2VjdGlvbihcclxuICB7XHJcbiAgICByZW5kZXJlcjogKGl0ZW0pID0+IHtcclxuICAgICAgY29uc3QgY2FyZEVsID0gY3JlYXRlQ2FyZChpdGVtKTtcclxuICAgICAgY2FyZFNlY3Rpb24uYWRkSXRlbShjYXJkRWwpO1xyXG4gICAgfSxcclxuICB9LFxyXG4gIGNhcmRMaXN0XHJcbik7XHJcblxyXG4vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cclxuLy8gLS0tLS0gUE9QVVBTIC0tLS0tIC8vXHJcbi8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xyXG5cclxuY29uc3QgdXNlckluZm9ybWF0aW9uID0gbmV3IFVzZXJJbmZvKHtcclxuICBuYW1lU2VsZWN0b3I6IFwiLnByb2ZpbGVfX3RpdGxlXCIsXHJcbiAgZGVzY3JpcHRpb25TZWxlY3RvcjogXCIucHJvZmlsZV9fZGVzY3JpcHRpb25cIixcclxuICBhdmF0YXJTZWxlY3RvcjogXCIucHJvZmlsZV9fYXZhdGFyXCIsXHJcbn0pO1xyXG5cclxuY29uc3QgZWRpdFByb2ZpbGVQb3B1cCA9IG5ldyBQb3B1cFdpdGhGb3JtKFwiI21vZGFsX19lZGl0LXByb2ZpbGVcIiwgKGRhdGEpID0+IHtcclxuICBlZGl0UHJvZmlsZVBvcHVwLnNldEJ1dHRvblRleHQoXCJTYXZpbmcuLi5cIik7XHJcbiAgYXBpXHJcbiAgICAuZWRpdFVzZXJJbmZvcm1hdGlvbihkYXRhKVxyXG4gICAgLnRoZW4oKGRhdGEpID0+IHtcclxuICAgICAgdXNlckluZm9ybWF0aW9uLnNldFVzZXJJbmZvKGRhdGEpO1xyXG4gICAgICB1c2VySW5mb3JtYXRpb24uc2V0QXZhdGFyKGRhdGEpO1xyXG4gICAgICBlZGl0UHJvZmlsZVBvcHVwLmNsb3NlKCk7XHJcbiAgICB9KVxyXG4gICAgLmZpbmFsbHkoKCkgPT4ge1xyXG4gICAgICBlZGl0UHJvZmlsZVBvcHVwLnNldEJ1dHRvblRleHQoXCJTYXZlXCIpO1xyXG4gICAgfSlcclxuICAgIC5jYXRjaCgoZXJyKSA9PiBjb25zb2xlLmVycm9yKGVycikpO1xyXG59KTtcclxuZWRpdFByb2ZpbGVQb3B1cC5zZXRFdmVudExpc3RlbmVycygpO1xyXG5cclxuZWRpdFByb2ZpbGVCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICBlZGl0UHJvZmlsZVBvcHVwLm9wZW4oKTtcclxuICBjb25zdCB7IGRlc2NyaXB0aW9uLCBuYW1lIH0gPSB1c2VySW5mb3JtYXRpb24uZ2V0VXNlckluZm8oKTtcclxuICBtb2RhbFRpdGxlLnZhbHVlID0gbmFtZTtcclxuICBtb2RhbERlc2NyaXB0aW9uLnZhbHVlID0gZGVzY3JpcHRpb247XHJcbiAgZWRpdEZvcm1WYWxpZGF0b3IucmVzZXRWYWxpZGF0aW9uKCk7XHJcbn0pO1xyXG5cclxuY29uc3QgbmV3SXRlbVBvcHVwID0gbmV3IFBvcHVwV2l0aEZvcm0oXCIjbW9kYWxfX25ldy1pdGVtXCIsIChkYXRhKSA9PiB7XHJcbiAgbmV3SXRlbVBvcHVwLnNldEJ1dHRvblRleHQoXCJDcmVhdGluZy4uLlwiKTtcclxuICBhcGlcclxuICAgIC5hZGROZXdDYXJkKGRhdGEpXHJcbiAgICAudGhlbigoZGF0YSkgPT4ge1xyXG4gICAgICBjYXJkU2VjdGlvbi5yZW5kZXJJdGVtcyhbZGF0YV0pO1xyXG4gICAgICBuZXdJdGVtUG9wdXAuY2xvc2UoKTtcclxuICAgIH0pXHJcbiAgICAuZmluYWxseSgoKSA9PiB7XHJcbiAgICAgIG5ld0l0ZW1Qb3B1cC5zZXRCdXR0b25UZXh0KFwiQ3JlYXRlXCIpO1xyXG4gICAgfSlcclxuICAgIC5jYXRjaCgoZXJyKSA9PiBjb25zb2xlLmVycm9yKGVycikpO1xyXG59KTtcclxubmV3SXRlbVBvcHVwLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcbm5ld0l0ZW1Nb2RhbE9wZW4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICBuZXdJdGVtUG9wdXAub3BlbigpO1xyXG4gIG5ld0l0ZW1Gb3JtVmFsaWRhdG9yLnJlc2V0VmFsaWRhdGlvbigpO1xyXG59KTtcclxuXHJcbmNvbnN0IGVkaXRBdmF0YXJQb3B1cCA9IG5ldyBQb3B1cFdpdGhGb3JtKFwiI21vZGFsX191cGRhdGUtYXZhdGFyXCIsIChkYXRhKSA9PiB7XHJcbiAgZWRpdEF2YXRhclBvcHVwLnNldEJ1dHRvblRleHQoXCJTYXZpbmcuLi5cIik7XHJcbiAgYXBpLnVwZGF0ZVByb2ZpbGVQaWN0dXJlKGRhdGEpLnRoZW4oKGRhdGEpID0+IHtcclxuICAgIGFwaVxyXG4gICAgICAuZ2V0VXNlckluZm9ybWF0aW9uKGRhdGEpXHJcbiAgICAgIC50aGVuKChkYXRhKSA9PiB7XHJcbiAgICAgICAgdXNlckluZm9ybWF0aW9uLnNldEF2YXRhcihkYXRhKTtcclxuICAgICAgICBlZGl0QXZhdGFyUG9wdXAuY2xvc2UoKTtcclxuICAgICAgfSlcclxuICAgICAgLmZpbmFsbHkoKCkgPT4ge1xyXG4gICAgICAgIGVkaXRBdmF0YXJQb3B1cC5zZXRCdXR0b25UZXh0KFwiU2F2ZVwiKTtcclxuICAgICAgfSlcclxuICAgICAgLmNhdGNoKChlcnIpID0+IGNvbnNvbGUuZXJyb3IoZXJyKSk7XHJcbiAgfSk7XHJcbn0pO1xyXG5lZGl0QXZhdGFyUG9wdXAuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxudXBkYXRlQXZhdGFyQ29udGFpbmVyLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgZWRpdEF2YXRhclBvcHVwLm9wZW4oKTtcclxufSk7XHJcblxyXG5jb25zdCBkZWxldGVDYXJkUG9wdXAgPSBuZXcgUG9wdXBXaXRoQ29uZmlybWF0aW9uKFwiI21vZGFsX19kZWxldGUtcGljdHVyZVwiKTtcclxuZGVsZXRlQ2FyZFBvcHVwLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcblxyXG5jb25zdCBwcmV2aWV3UGljdHVyZVBvcHVwID0gbmV3IFBvcHVwV2l0aEltYWdlKFwiI21vZGFsX19waWN0dXJlLXBvcHVwXCIpO1xyXG5wcmV2aWV3UGljdHVyZVBvcHVwLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcblxyXG4vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cclxuLy8gLS0tLS0gRk9STSBWQUxJREFUSU9OIC0tLS0tIC8vXHJcbi8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xyXG5cclxuY29uc3QgZWRpdEZvcm1WYWxpZGF0b3IgPSBuZXcgRm9ybVZhbGlkYXRvcihvcHRpb25zLCBlZGl0UHJvZmlsZU1vZGFsRm9ybSk7XHJcbmVkaXRGb3JtVmFsaWRhdG9yLmVuYWJsZVZhbGlkYXRpb24oKTtcclxuY29uc3QgbmV3SXRlbUZvcm1WYWxpZGF0b3IgPSBuZXcgRm9ybVZhbGlkYXRvcihvcHRpb25zLCBuZXdJdGVtTW9kYWxGb3JtKTtcclxubmV3SXRlbUZvcm1WYWxpZGF0b3IuZW5hYmxlVmFsaWRhdGlvbigpO1xyXG5jb25zdCB1cGRhdGVBdmF0YXJGb3JtVmFsaWRhdG9yID0gbmV3IEZvcm1WYWxpZGF0b3Iob3B0aW9ucywgdXBkYXRlQXZhdGFyRm9ybSk7XHJcbnVwZGF0ZUF2YXRhckZvcm1WYWxpZGF0b3IuZW5hYmxlVmFsaWRhdGlvbigpO1xyXG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBBcGkge1xyXG4gIGNvbnN0cnVjdG9yKHsgYmFzZVVybCwgaGVhZGVycyB9KSB7XHJcbiAgICB0aGlzLl9iYXNlVXJsID0gYmFzZVVybDtcclxuICAgIHRoaXMuX2F1dGhvcml6YXRpb24gPSBoZWFkZXJzLmF1dGhvcml6YXRpb247XHJcbiAgICB0aGlzLl9jb250ZW50VHlwZSA9IGhlYWRlcnNbXCJjb250ZW50LXR5cGVcIl07XHJcbiAgfVxyXG5cclxuICBnZXRVc2VySW5mb3JtYXRpb24oKSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vdXNlcnMvbWVgLCB7XHJcbiAgICAgIGhlYWRlcnM6IHtcclxuICAgICAgICBhdXRob3JpemF0aW9uOiB0aGlzLl9hdXRob3JpemF0aW9uLFxyXG4gICAgICAgIFwiY29udGVudC10eXBlXCI6IHRoaXMuX2NvbnRlbnRUeXBlLFxyXG4gICAgICB9LFxyXG4gICAgfSkudGhlbih0aGlzLl9oYW5kbGVTZXJ2ZXJSZXNwb25zZSk7XHJcbiAgfVxyXG5cclxuICBlZGl0VXNlckluZm9ybWF0aW9uKGRhdGEpIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS91c2Vycy9tZWAsIHtcclxuICAgICAgbWV0aG9kOiBcIlBBVENIXCIsXHJcbiAgICAgIGhlYWRlcnM6IHtcclxuICAgICAgICBhdXRob3JpemF0aW9uOiB0aGlzLl9hdXRob3JpemF0aW9uLFxyXG4gICAgICAgIFwiY29udGVudC10eXBlXCI6IHRoaXMuX2NvbnRlbnRUeXBlLFxyXG4gICAgICB9LFxyXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XHJcbiAgICAgICAgbmFtZTogZGF0YS50aXRsZSxcclxuICAgICAgICBhYm91dDogZGF0YS5zdWJ0aXRsZSxcclxuICAgICAgfSksXHJcbiAgICB9KS50aGVuKHRoaXMuX2hhbmRsZVNlcnZlclJlc3BvbnNlKTtcclxuICB9XHJcblxyXG4gIGFkZE5ld0NhcmQoZGF0YSkge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzYCwge1xyXG4gICAgICBtZXRob2Q6IFwiUE9TVFwiLFxyXG4gICAgICBoZWFkZXJzOiB7XHJcbiAgICAgICAgYXV0aG9yaXphdGlvbjogdGhpcy5fYXV0aG9yaXphdGlvbixcclxuICAgICAgICBcImNvbnRlbnQtdHlwZVwiOiB0aGlzLl9jb250ZW50VHlwZSxcclxuICAgICAgfSxcclxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xyXG4gICAgICAgIG5hbWU6IGRhdGEubmFtZSxcclxuICAgICAgICBsaW5rOiBkYXRhLmxpbmssXHJcbiAgICAgIH0pLFxyXG4gICAgfSkudGhlbih0aGlzLl9oYW5kbGVTZXJ2ZXJSZXNwb25zZSk7XHJcbiAgfVxyXG5cclxuICBoYW5kbGVEZWxldGVDYXJkKGNhcmRJZCkge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzL2AgKyBjYXJkSWQsIHtcclxuICAgICAgbWV0aG9kOiBcIkRFTEVURVwiLFxyXG4gICAgICBoZWFkZXJzOiB7XHJcbiAgICAgICAgYXV0aG9yaXphdGlvbjogdGhpcy5fYXV0aG9yaXphdGlvbixcclxuICAgICAgICBcImNvbnRlbnQtdHlwZVwiOiB0aGlzLl9jb250ZW50VHlwZSxcclxuICAgICAgfSxcclxuICAgIH0pLnRoZW4odGhpcy5faGFuZGxlU2VydmVyUmVzcG9uc2UpO1xyXG4gIH1cclxuXHJcbiAgZ2V0SW5pdGlhbENhcmRzKCkge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzYCwge1xyXG4gICAgICBoZWFkZXJzOiB7XHJcbiAgICAgICAgYXV0aG9yaXphdGlvbjogdGhpcy5fYXV0aG9yaXphdGlvbixcclxuICAgICAgICBcImNvbnRlbnQtdHlwZVwiOiB0aGlzLl9jb250ZW50VHlwZSxcclxuICAgICAgfSxcclxuICAgIH0pLnRoZW4odGhpcy5faGFuZGxlU2VydmVyUmVzcG9uc2UpO1xyXG4gIH1cclxuXHJcbiAgaGFuZGxlU3VibWl0TGlrZShjYXJkSUQpIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkcy9saWtlcy9gICsgY2FyZElELCB7XHJcbiAgICAgIG1ldGhvZDogXCJQVVRcIixcclxuICAgICAgaGVhZGVyczoge1xyXG4gICAgICAgIGF1dGhvcml6YXRpb246IHRoaXMuX2F1dGhvcml6YXRpb24sXHJcbiAgICAgICAgXCJjb250ZW50LXR5cGVcIjogdGhpcy5fY29udGVudFR5cGUsXHJcbiAgICAgIH0sXHJcbiAgICB9KS50aGVuKHRoaXMuX2hhbmRsZVNlcnZlclJlc3BvbnNlKTtcclxuICB9XHJcblxyXG4gIGhhbmRsZURlbGV0ZUxpa2UoY2FyZElEKSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHMvbGlrZXMvYCArIGNhcmRJRCwge1xyXG4gICAgICBtZXRob2Q6IFwiREVMRVRFXCIsXHJcbiAgICAgIGhlYWRlcnM6IHtcclxuICAgICAgICBhdXRob3JpemF0aW9uOiB0aGlzLl9hdXRob3JpemF0aW9uLFxyXG4gICAgICAgIFwiY29udGVudC10eXBlXCI6IHRoaXMuX2NvbnRlbnRUeXBlLFxyXG4gICAgICB9LFxyXG4gICAgfSkudGhlbih0aGlzLl9oYW5kbGVTZXJ2ZXJSZXNwb25zZSk7XHJcbiAgfVxyXG5cclxuICB1cGRhdGVQcm9maWxlUGljdHVyZShkYXRhKSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vdXNlcnMvbWUvYXZhdGFyYCwge1xyXG4gICAgICBtZXRob2Q6IFwiUEFUQ0hcIixcclxuICAgICAgaGVhZGVyczoge1xyXG4gICAgICAgIGF1dGhvcml6YXRpb246IHRoaXMuX2F1dGhvcml6YXRpb24sXHJcbiAgICAgICAgXCJjb250ZW50LXR5cGVcIjogdGhpcy5fY29udGVudFR5cGUsXHJcbiAgICAgIH0sXHJcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcclxuICAgICAgICBhdmF0YXI6IGRhdGEuYXZhdGFyLFxyXG4gICAgICB9KSxcclxuICAgIH0pLnRoZW4odGhpcy5faGFuZGxlU2VydmVyUmVzcG9uc2UpO1xyXG4gIH1cclxuXHJcbiAgX2hhbmRsZVNlcnZlclJlc3BvbnNlKHJlcykge1xyXG4gICAgcmV0dXJuIHJlcy5vayA/IHJlcy5qc29uKCkgOiBQcm9taXNlLnJlamVjdChgRXJyb3I6ICR7cmVzLnN0YXR1c31gKTtcclxuICB9XHJcbn1cclxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgU2VjdGlvbiB7XHJcbiAgY29uc3RydWN0b3IoeyByZW5kZXJlciB9LCBzZWxlY3Rvcikge1xyXG4gICAgdGhpcy5fcmVuZGVyZXIgPSByZW5kZXJlcjtcclxuICAgIHRoaXMuX2NvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3Ioc2VsZWN0b3IpO1xyXG4gIH1cclxuXHJcbiAgcmVuZGVySXRlbXMgPSAoaXRlbXMpID0+IHtcclxuICAgIGl0ZW1zLmZvckVhY2goKGl0ZW0pID0+IHtcclxuICAgICAgdGhpcy5fcmVuZGVyZXIoaXRlbSk7XHJcbiAgICB9KTtcclxuICB9O1xyXG5cclxuICBhZGRJdGVtKGl0ZW0pIHtcclxuICAgIHRoaXMuX2NvbnRhaW5lci5wcmVwZW5kKGl0ZW0pO1xyXG4gIH1cclxufVxyXG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBVc2VySW5mbyB7XHJcbiAgY29uc3RydWN0b3IoeyBuYW1lU2VsZWN0b3IsIGRlc2NyaXB0aW9uU2VsZWN0b3IsIGF2YXRhclNlbGVjdG9yIH0pIHtcclxuICAgIHRoaXMuX25hbWUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKG5hbWVTZWxlY3Rvcik7XHJcbiAgICB0aGlzLl9kZXNjcmlwdGlvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoZGVzY3JpcHRpb25TZWxlY3Rvcik7XHJcbiAgICB0aGlzLl9hdmF0YXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGF2YXRhclNlbGVjdG9yKTtcclxuICB9XHJcblxyXG4gIGdldFVzZXJJbmZvKCkge1xyXG4gICAgY29uc3QgbmFtZSA9IHRoaXMuX25hbWUudGV4dENvbnRlbnQ7XHJcbiAgICBjb25zdCBkZXNjcmlwdGlvbiA9IHRoaXMuX2Rlc2NyaXB0aW9uLnRleHRDb250ZW50O1xyXG4gICAgcmV0dXJuIHsgbmFtZSwgZGVzY3JpcHRpb24gfTtcclxuICB9XHJcblxyXG4gIHNldFVzZXJJbmZvKGRhdGEpIHtcclxuICAgIHRoaXMuX25hbWUudGV4dENvbnRlbnQgPSBkYXRhLm5hbWU7XHJcbiAgICB0aGlzLl9kZXNjcmlwdGlvbi50ZXh0Q29udGVudCA9IGRhdGEuYWJvdXQ7XHJcbiAgfVxyXG5cclxuICBzZXRBdmF0YXIoZGF0YSkge1xyXG4gICAgdGhpcy5fYXZhdGFyLnNyYyA9IGRhdGEuYXZhdGFyO1xyXG4gIH1cclxufVxyXG4iLCJpbXBvcnQgUG9wdXAgZnJvbSBcIi4vUG9wdXAuanNcIjtcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwV2l0aENvbmZpcm1hdGlvbiBleHRlbmRzIFBvcHVwIHtcclxuICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yKSB7XHJcbiAgICBzdXBlcih7IHBvcHVwU2VsZWN0b3IgfSk7XHJcbiAgICB0aGlzLl9wb3B1cEZvcm0gPSB0aGlzLl9wb3B1cEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fZm9ybVwiKTtcclxuICAgIHRoaXMuX3NhdmVCdXR0b24gPSB0aGlzLl9wb3B1cEZvcm0ucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fc2F2ZVwiKTtcclxuICB9XHJcblxyXG4gIHNldFN1Ym1pdEFjdGlvbihhY3Rpb24pIHtcclxuICAgIC8vIHRoaXMuX3BvcHVwRm9ybS5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsICgpID0+IHt9KTtcclxuICAgIHRoaXMuX3N1Ym1pdEFjdGlvbiA9IGFjdGlvbjtcclxuICB9XHJcblxyXG4gIHNldEJ1dHRvblRleHQoZGF0YSkge1xyXG4gICAgdGhpcy5fc2F2ZUJ1dHRvbi50ZXh0Q29udGVudCA9IGRhdGE7XHJcbiAgfVxyXG5cclxuICBzZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgIHN1cGVyLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcbiAgICAvLyBzZXQgc3VibWl0IHN1Ym1pdFxyXG4gICAgLy8gd2l0aCB0aGlzLl9zdWJtaXRBY3Rpb24gYXMgaXRzIGhhbmRsZXJcclxuICAgIHRoaXMuX3BvcHVwRm9ybS5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIChlLCBhY3Rpb24pID0+IHtcclxuICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICB0aGlzLl9zdWJtaXRBY3Rpb24oYWN0aW9uKTtcclxuICAgIH0pO1xyXG4gIH1cclxufVxyXG4iLCJpbXBvcnQgUG9wdXAgZnJvbSBcIi4vUG9wdXAuanNcIjtcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwV2l0aEltYWdlIGV4dGVuZHMgUG9wdXAge1xyXG4gIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IpIHtcclxuICAgIHN1cGVyKHsgcG9wdXBTZWxlY3RvciB9KTtcclxuICAgIHRoaXMuX3ByZXZpZXdJbWFnZSA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19waWN0dXJlXCIpO1xyXG4gICAgdGhpcy5fcHJldmlld0NhcHRpb24gPSB0aGlzLl9wb3B1cEVsZW1lbnQucXVlcnlTZWxlY3RvcihcclxuICAgICAgXCIubW9kYWxfX2ltYWdlLWRlc2NyaXB0aW9uXCJcclxuICAgICk7XHJcbiAgfVxyXG5cclxuICBvcGVuKGRhdGEpIHtcclxuICAgIHN1cGVyLm9wZW4oKTtcclxuICAgIHRoaXMuX3ByZXZpZXdJbWFnZS5zcmMgPSBkYXRhLmxpbms7XHJcbiAgICB0aGlzLl9wcmV2aWV3SW1hZ2UuYWx0ID0gZGF0YS5uYW1lO1xyXG4gICAgdGhpcy5fcHJldmlld0NhcHRpb24udGV4dENvbnRlbnQgPSBkYXRhLm5hbWU7XHJcbiAgfVxyXG59XHJcbiJdLCJuYW1lcyI6WyJjb25zdHJ1Y3RvciIsIm9wdGlvbnMiLCJmb3JtIiwidGhpcyIsIl9pbnB1dFNlbGVjdG9yIiwiaW5wdXRTZWxlY3RvciIsIl9zdWJtaXRCdXR0b25TZWxlY3RvciIsInN1Ym1pdEJ1dHRvblNlbGVjdG9yIiwiX2luYWN0aXZlQnV0dG9uQ2xhc3MiLCJpbmFjdGl2ZUJ1dHRvbkNsYXNzIiwiX2lucHV0RXJyb3JDbGFzcyIsImlucHV0RXJyb3JDbGFzcyIsIl9lcnJvckNsYXNzIiwiZXJyb3JDbGFzcyIsIl9mb3JtIiwiX3Nob3dJbnB1dEVycm9yIiwiaW5wdXRFbCIsImlucHV0RXJyb3IiLCJxdWVyeVNlbGVjdG9yIiwiaWQiLCJjbGFzc0xpc3QiLCJhZGQiLCJ0ZXh0Q29udGVudCIsInZhbGlkYXRpb25NZXNzYWdlIiwiX2hpZGVJbnB1dEVycm9yIiwicmVtb3ZlIiwiX2NoZWNrSW5wdXRWYWxpZGl0eSIsInZhbGlkaXR5IiwidmFsaWQiLCJfY2hlY2tGb3JtVmFsaWRpdHkiLCJpbnB1dHMiLCJldmVyeSIsImlucHV0IiwiZGlzYWJsZVN1Ym1pdEJ1dHRvbiIsIl9zdWJtaXRCdXR0b24iLCJkaXNhYmxlZCIsImVuYWJsZVN1Ym1pdEJ1dHRvbiIsInJlc2V0VmFsaWRhdGlvbiIsIl90b2dnbGVCdXR0b25TdGF0ZSIsIl9pbnB1dEVscyIsImZvckVhY2giLCJfc2V0RXZlbnRMaXN0ZW5lcnMiLCJxdWVyeVNlbGVjdG9yQWxsIiwiYWRkRXZlbnRMaXN0ZW5lciIsImVuYWJsZVZhbGlkYXRpb24iLCJldnQiLCJwcmV2ZW50RGVmYXVsdCIsIkNhcmQiLCJkYXRhIiwidGVtcGxhdGVTZWxlY3RvciIsImhhbmRsZUltYWdlQ2xpY2siLCJoYW5kbGVEZWxldGVDYXJkIiwiaGFuZGxlTGlrZSIsInVzZXJJZCIsIl9uYW1lIiwibmFtZSIsIl9saW5rIiwibGluayIsIl9vd25lcklkIiwib3duZXIiLCJfaWQiLCJfY2FyZElkIiwiX2xpa2VzIiwibGlrZXMiLCJfdGVtcGxhdGVTZWxlY3RvciIsIl9oYW5kbGVJbWFnZUNsaWNrIiwiX2hhbmRsZUxpa2UiLCJfaGFuZGxlRGVsZXRlQ2FyZCIsIl91c2VySWQiLCJfbGlrZUJ1dHRvbiIsIl9kZWxldGVCdXR0b24iLCJfY2FyZEltYWdlIiwiZGVsZXRlQ2FyZCIsIl9jYXJkIiwidXBkYXRlTGlrZXMiLCJfcmVuZGVyTGlrZXMiLCJpc0xpa2VkIiwic29tZSIsImxpa2UiLCJfbGlrZU51bWJlciIsImxlbmd0aCIsImdldFZpZXciLCJkb2N1bWVudCIsImNvbnRlbnQiLCJjbG9uZU5vZGUiLCJfY2FyZFRpdGxlIiwiYWx0Iiwic3JjIiwiUG9wdXAiLCJfcmVmIiwicG9wdXBTZWxlY3RvciIsIl9wb3B1cEVsZW1lbnQiLCJfcG9wdXBDbG9zZUJ1dHRvbiIsIm9wZW4iLCJfaGFuZGxlUmVtb3RlQ2xvc2UiLCJfaGFuZGxlRXNjQ2xvc2UiLCJjbG9zZSIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJrZXkiLCJ0YXJnZXQiLCJjb250YWlucyIsInNldEV2ZW50TGlzdGVuZXJzIiwiUG9wdXBXaXRoRm9ybSIsImhhbmRsZUZvcm1TdWJtaXQiLCJzdXBlciIsIl9wb3B1cEZvcm0iLCJfaGFuZGxlRm9ybVN1Ym1pdCIsIl9zYXZlQnV0dG9uIiwicmVzZXQiLCJzZXRCdXR0b25UZXh0IiwiX2dldElucHV0VmFsdWVzIiwiX2lucHV0VmFsdWVzIiwiX2lucHV0RWxlbWVudHMiLCJlbGVtZW50IiwidmFsdWUiLCJ1cGRhdGVBdmF0YXJDb250YWluZXIiLCJ1cGRhdGVBdmF0YXJGb3JtIiwiZm9ybXMiLCJlZGl0UHJvZmlsZUJ1dHRvbiIsIm1vZGFsVGl0bGUiLCJtb2RhbERlc2NyaXB0aW9uIiwiZWRpdFByb2ZpbGVNb2RhbEZvcm0iLCJuZXdJdGVtTW9kYWxPcGVuIiwibmV3SXRlbU1vZGFsRm9ybSIsImFwaSIsImJhc2VVcmwiLCJoZWFkZXJzIiwiX2Jhc2VVcmwiLCJfYXV0aG9yaXphdGlvbiIsImF1dGhvcml6YXRpb24iLCJfY29udGVudFR5cGUiLCJnZXRVc2VySW5mb3JtYXRpb24iLCJmZXRjaCIsInRoZW4iLCJfaGFuZGxlU2VydmVyUmVzcG9uc2UiLCJlZGl0VXNlckluZm9ybWF0aW9uIiwibWV0aG9kIiwiYm9keSIsIkpTT04iLCJzdHJpbmdpZnkiLCJ0aXRsZSIsImFib3V0Iiwic3VidGl0bGUiLCJhZGROZXdDYXJkIiwiY2FyZElkIiwiZ2V0SW5pdGlhbENhcmRzIiwiaGFuZGxlU3VibWl0TGlrZSIsImNhcmRJRCIsImhhbmRsZURlbGV0ZUxpa2UiLCJ1cGRhdGVQcm9maWxlUGljdHVyZSIsImF2YXRhciIsInJlcyIsIm9rIiwianNvbiIsIlByb21pc2UiLCJyZWplY3QiLCJzdGF0dXMiLCJhbGwiLCJ1c2VyIiwiY2FyZHMiLCJ1c2VySW5mb3JtYXRpb24iLCJzZXRVc2VySW5mbyIsInNldEF2YXRhciIsImNhcmRTZWN0aW9uIiwicmVuZGVySXRlbXMiLCJyZXZlcnNlIiwiY2F0Y2giLCJlcnIiLCJjb25zb2xlIiwiZXJyb3IiLCJzZWxlY3RvciIsInJlbmRlcmVyIiwiX3JlbmRlcmVyIiwiX2NvbnRhaW5lciIsIml0ZW1zIiwiaXRlbSIsImFkZEl0ZW0iLCJwcmVwZW5kIiwiY2FyZEVsIiwiY2FyZCIsInByZXZpZXdQaWN0dXJlUG9wdXAiLCJkZWxldGVDYXJkUG9wdXAiLCJzZXRTdWJtaXRBY3Rpb24iLCJmaW5hbGx5IiwicmVzcG9uc2UiLCJjcmVhdGVDYXJkIiwibmFtZVNlbGVjdG9yIiwiZGVzY3JpcHRpb25TZWxlY3RvciIsImF2YXRhclNlbGVjdG9yIiwiX2Rlc2NyaXB0aW9uIiwiX2F2YXRhciIsImdldFVzZXJJbmZvIiwiZGVzY3JpcHRpb24iLCJlZGl0UHJvZmlsZVBvcHVwIiwiZWRpdEZvcm1WYWxpZGF0b3IiLCJuZXdJdGVtUG9wdXAiLCJuZXdJdGVtRm9ybVZhbGlkYXRvciIsImVkaXRBdmF0YXJQb3B1cCIsImFjdGlvbiIsIl9zdWJtaXRBY3Rpb24iLCJlIiwiX3ByZXZpZXdJbWFnZSIsIl9wcmV2aWV3Q2FwdGlvbiIsIkZvcm1WYWxpZGF0b3IiXSwic291cmNlUm9vdCI6IiJ9